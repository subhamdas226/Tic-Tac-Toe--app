{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar difficulties = {\n  \"1\": \"Beginner\",\n  \"3\": \"Intermediate\",\n  \"4\": \"Hard\",\n  \"-1\": \"Impossible\"\n};\nvar defaultSettings = {\n  difficulty: \"-1\",\n  haptics: true,\n  sounds: true\n};\nvar SettingsContext = createContext(undefined);\nfunction useSettings() {\n  var context = useContext(SettingsContext);\n  if (!context) {\n    throw new Error(\"useSetting must be within settingsProvider\");\n  }\n  return context;\n}\nfunction SettingsProvider(props) {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    settings = _useState2[0],\n    setSettings = _useState2[1];\n  useEffect(function () {\n    loadSettings();\n  }, []);\n  var saveSetting = function () {\n    var _ref = _asyncToGenerator(function* (setting, value) {\n      try {\n        var oldSettings = settings ? settings : defaultSettings;\n        var newSettings = _objectSpread(_objectSpread({}, oldSettings), {}, _defineProperty({}, setting, value));\n        var jsonSettings = JSON.stringify(newSettings);\n        yield AsyncStorage.setItem(\"@settings\", jsonSettings);\n        setSettings(newSettings);\n      } catch (error) {\n        Alert.alert(\"Error!\", \"An error has occured\");\n      }\n    });\n    return function saveSetting(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var loadSettings = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var _settings = yield AsyncStorage.getItem(\"@settings\");\n        console.log(\"async sett\", _settings);\n        _settings !== null ? setSettings(JSON.parse(_settings)) : setSettings(defaultSettings);\n      } catch (error) {\n        setSettings(defaultSettings);\n      }\n    });\n    return function loadSettings() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsx(SettingsContext.Provider, _objectSpread(_objectSpread({}, props), {}, {\n    value: {\n      settings: settings,\n      saveSetting: saveSetting,\n      loadSettings: loadSettings\n    }\n  }));\n}\nexport { useSettings, SettingsProvider, difficulties };\nexport default SettingsContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","AsyncStorage","jsx","_jsx","difficulties","defaultSettings","difficulty","haptics","sounds","SettingsContext","undefined","useSettings","context","Error","SettingsProvider","props","_useState","_useState2","_slicedToArray","settings","setSettings","loadSettings","saveSetting","_ref","_asyncToGenerator","setting","value","oldSettings","newSettings","_objectSpread","_defineProperty","jsonSettings","JSON","stringify","setItem","error","Alert","alert","_x","_x2","apply","arguments","_ref2","getItem","console","log","parse","Provider"],"sources":["E:/projects/Tic-Tac-Toe--app/src/contexts/settings-context.tsx"],"sourcesContent":["import { View, Text, Alert } from \"react-native\";\r\nimport React, {\r\n  ReactElement,\r\n  ReactNode,\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n\r\nconst difficulties: Record<string, string> = {\r\n  \"1\": \"Beginner\",\r\n  \"3\": \"Intermediate\",\r\n  \"4\": \"Hard\",\r\n  \"-1\": \"Impossible\",\r\n};\r\n\r\ntype SettingsType = {\r\n  difficulty: keyof typeof difficulties;\r\n  haptics: boolean;\r\n  sounds: boolean;\r\n};\r\n\r\nconst defaultSettings: SettingsType = {\r\n  difficulty: \"-1\",\r\n  haptics: true,\r\n  sounds: true,\r\n};\r\n\r\ntype SettingsContextType = {\r\n  settings: SettingsType | null;\r\n  loadSettings: () => void;\r\n  saveSetting: <T extends keyof SettingsType>(\r\n    settings: T,\r\n    value: SettingsType[T]\r\n  ) => void;\r\n};\r\n\r\nconst SettingsContext = createContext<SettingsContextType | undefined>(\r\n  undefined\r\n);\r\n\r\nfunction useSettings(): SettingsContextType {\r\n  const context = useContext(SettingsContext);\r\n  if (!context) {\r\n    throw new Error(\"useSetting must be within settingsProvider\");\r\n  }\r\n  return context;\r\n}\r\n\r\nfunction SettingsProvider(props: { children: ReactNode }): ReactElement {\r\n  const [settings, setSettings] = useState<SettingsType | null>(null);\r\n  useEffect(() => {\r\n    //  AsyncStorage.removeItem(\"@settings\");\r\n\r\n    loadSettings();\r\n  }, []);\r\n  const saveSetting = async <T extends keyof SettingsType>(\r\n    setting: T,\r\n    value: SettingsType[T]\r\n  ) => {\r\n    try {\r\n      const oldSettings: any = settings ? settings : defaultSettings;\r\n\r\n      const newSettings = { ...oldSettings, [setting]: value };\r\n      const jsonSettings = JSON.stringify(newSettings);\r\n      await AsyncStorage.setItem(\"@settings\", jsonSettings);\r\n      setSettings(newSettings);\r\n    } catch (error) {\r\n      Alert.alert(\"Error!\", \"An error has occured\");\r\n    }\r\n  };\r\n\r\n  const loadSettings = async () => {\r\n    try {\r\n      const settings = await AsyncStorage.getItem(\"@settings\");\r\n      console.log(\"async sett\", settings);\r\n\r\n      settings !== null\r\n        ? setSettings(JSON.parse(settings))\r\n        : setSettings(defaultSettings);\r\n    } catch (error) {\r\n      setSettings(defaultSettings);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SettingsContext.Provider\r\n      {...props}\r\n      value={{\r\n        settings,\r\n        saveSetting,\r\n        loadSettings,\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nexport { useSettings, SettingsProvider, difficulties };\r\nexport default SettingsContext;\r\n"],"mappings":";;;;;;AACA,OAAOA,KAAK,IAGVC,aAAa,EACbC,UAAU,EACVC,SAAS,EACTC,QAAQ,QACH,OAAO;AACd,OAAOC,YAAY,MAAM,2CAA2C;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAErE,IAAMC,YAAoC,GAAG;EAC3C,GAAG,EAAE,UAAU;EACf,GAAG,EAAE,cAAc;EACnB,GAAG,EAAE,MAAM;EACX,IAAI,EAAE;AACR,CAAC;AAQD,IAAMC,eAA6B,GAAG;EACpCC,UAAU,EAAE,IAAI;EAChBC,OAAO,EAAE,IAAI;EACbC,MAAM,EAAE;AACV,CAAC;AAWD,IAAMC,eAAe,GAAGZ,aAAa,CACnCa,SAAS,CACV;AAED,SAASC,WAAWA,CAAA,EAAwB;EAC1C,IAAMC,OAAO,GAAGd,UAAU,CAACW,eAAe,CAAC;EAC3C,IAAI,CAACG,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,4CAA4C,CAAC;EAC/D;EACA,OAAOD,OAAO;AAChB;AAEA,SAASE,gBAAgBA,CAACC,KAA8B,EAAgB;EACtE,IAAAC,SAAA,GAAgChB,QAAQ,CAAsB,IAAI,CAAC;IAAAiB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA5DG,QAAQ,GAAAF,UAAA;IAAEG,WAAW,GAAAH,UAAA;EAC5BlB,SAAS,CAAC,YAAM;IAGdsB,YAAY,EAAE;EAChB,CAAC,EAAE,EAAE,CAAC;EACN,IAAMC,WAAW;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAClBC,OAAU,EACVC,KAAsB,EACnB;MACH,IAAI;QACF,IAAMC,WAAgB,GAAGR,QAAQ,GAAGA,QAAQ,GAAGd,eAAe;QAE9D,IAAMuB,WAAW,GAAAC,aAAA,CAAAA,aAAA,KAAQF,WAAW,OAAAG,eAAA,KAAGL,OAAO,EAAGC,KAAK,EAAE;QACxD,IAAMK,YAAY,GAAGC,IAAI,CAACC,SAAS,CAACL,WAAW,CAAC;QAChD,MAAM3B,YAAY,CAACiC,OAAO,CAAC,WAAW,EAAEH,YAAY,CAAC;QACrDX,WAAW,CAACQ,WAAW,CAAC;MAC1B,CAAC,CAAC,OAAOO,KAAK,EAAE;QACdC,KAAK,CAACC,KAAK,CAAC,QAAQ,EAAE,sBAAsB,CAAC;MAC/C;IACF,CAAC;IAAA,gBAdKf,WAAWA,CAAAgB,EAAA,EAAAC,GAAA;MAAA,OAAAhB,IAAA,CAAAiB,KAAA,OAAAC,SAAA;IAAA;EAAA,GAchB;EAED,IAAMpB,YAAY;IAAA,IAAAqB,KAAA,GAAAlB,iBAAA,CAAG,aAAY;MAC/B,IAAI;QACF,IAAML,SAAQ,SAASlB,YAAY,CAAC0C,OAAO,CAAC,WAAW,CAAC;QACxDC,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE1B,SAAQ,CAAC;QAEnCA,SAAQ,KAAK,IAAI,GACbC,WAAW,CAACY,IAAI,CAACc,KAAK,CAAC3B,SAAQ,CAAC,CAAC,GACjCC,WAAW,CAACf,eAAe,CAAC;MAClC,CAAC,CAAC,OAAO8B,KAAK,EAAE;QACdf,WAAW,CAACf,eAAe,CAAC;MAC9B;IACF,CAAC;IAAA,gBAXKgB,YAAYA,CAAA;MAAA,OAAAqB,KAAA,CAAAF,KAAA,OAAAC,SAAA;IAAA;EAAA,GAWjB;EAED,OACEtC,IAAA,CAACM,eAAe,CAACsC,QAAQ,EAAAlB,aAAA,CAAAA,aAAA,KACnBd,KAAK;IACTW,KAAK,EAAE;MACLP,QAAQ,EAARA,QAAQ;MACRG,WAAW,EAAXA,WAAW;MACXD,YAAY,EAAZA;IACF;EAAE,GACF;AAEN;AAEA,SAASV,WAAW,EAAEG,gBAAgB,EAAEV,YAAY;AACpD,eAAeK,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}